{
    "displayName": "High CPU Usage",
    "combiner": "OR",
    "conditions": [
      {
        "displayName": "CPU usage for API containers",
        "conditionThreshold": {
          "filter": "metric.type=\"kubernetes.io/container/cpu/core_usage_time\" resource.type=\"k8s_container\" metadata.system_labels.\"container_name\"=\"api\"",
          "aggregations": [
            {
              "alignmentPeriod": "60s",
              "perSeriesAligner": "ALIGN_RATE",
              "crossSeriesReducer": "REDUCE_MEAN",
              "groupByFields": [
                "resource.label.pod_name"
              ]
            }
          ],
          "comparison": "COMPARISON_GT",
          "thresholdValue": 0.8,
          "duration": "60s",
          "trigger": {
            "count": 1
          }
        }
      },
      {
        "displayName": "CPU usage for Web containers",
        "conditionThreshold": {
          "filter": "metric.type=\"kubernetes.io/container/cpu/core_usage_time\" resource.type=\"k8s_container\" metadata.system_labels.\"container_name\"=\"web\"",
          "aggregations": [
            {
              "alignmentPeriod": "60s",
              "perSeriesAligner": "ALIGN_RATE",
              "crossSeriesReducer": "REDUCE_MEAN",
              "groupByFields": [
                "resource.label.pod_name"
              ]
            }
          ],
          "comparison": "COMPARISON_GT",
          "thresholdValue": 0.8,
          "duration": "60s",
          "trigger": {
            "count": 1
          }
        }
      }
    ],
    "alertStrategy": {
      "autoClose": "604800s"
    },
    "documentation": {
      "content": "This policy triggers when CPU usage exceeds 80% of allocated capacity for any pod in the face detection application.",
      "mimeType": "text/markdown"
    },
    "severity": "WARNING"
  }