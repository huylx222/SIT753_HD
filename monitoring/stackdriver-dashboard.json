{
    "displayName": "Face Detection Application Dashboard",
    "gridLayout": {
      "columns": "2",
      "widgets": [
        {
          "title": "CPU Usage by Container",
          "xyChart": {
            "dataSets": [
              {
                "timeSeriesQuery": {
                  "timeSeriesFilter": {
                    "filter": "resource.type=\"k8s_container\" AND metric.type=\"kubernetes.io/container/cpu/core_usage_time\" AND resource.labels.container_name=\"api\" AND resource.labels.cluster_name=\"cluster-1\"",
                    "aggregation": {
                      "perSeriesAligner": "ALIGN_RATE",
                      "crossSeriesReducer": "REDUCE_NONE"
                    }
                  },
                  "unitOverride": "1"
                },
                "plotType": "LINE",
                "targetAxis": "Y1",
                "legendTemplate": "API"
              },
              {
                "timeSeriesQuery": {
                  "timeSeriesFilter": {
                    "filter": "resource.type=\"k8s_container\" AND metric.type=\"kubernetes.io/container/cpu/core_usage_time\" AND resource.labels.container_name=\"web\" AND resource.labels.cluster_name=\"cluster-1\"",
                    "aggregation": {
                      "perSeriesAligner": "ALIGN_RATE",
                      "crossSeriesReducer": "REDUCE_NONE"
                    }
                  },
                  "unitOverride": "1"
                },
                "plotType": "LINE",
                "targetAxis": "Y1",
                "legendTemplate": "Web"
              }
            ],
            "yAxis": {
              "label": "CPU usage (cores)",
              "scale": "LINEAR"
            }
          }
        },
        {
          "title": "Memory Usage by Container",
          "xyChart": {
            "dataSets": [
              {
                "timeSeriesQuery": {
                  "timeSeriesFilter": {
                    "filter": "resource.type=\"k8s_container\" AND metric.type=\"kubernetes.io/container/memory/used_bytes\" AND resource.labels.container_name=\"api\" AND resource.labels.cluster_name=\"cluster-1\"",
                    "aggregation": {
                      "perSeriesAligner": "ALIGN_MEAN",
                      "crossSeriesReducer": "REDUCE_NONE"
                    }
                  },
                  "unitOverride": "By"
                },
                "plotType": "LINE",
                "targetAxis": "Y1",
                "legendTemplate": "API"
              },
              {
                "timeSeriesQuery": {
                  "timeSeriesFilter": {
                    "filter": "resource.type=\"k8s_container\" AND metric.type=\"kubernetes.io/container/memory/used_bytes\" AND resource.labels.container_name=\"web\" AND resource.labels.cluster_name=\"cluster-1\"",
                    "aggregation": {
                      "perSeriesAligner": "ALIGN_MEAN",
                      "crossSeriesReducer": "REDUCE_NONE"
                    }
                  },
                  "unitOverride": "By"
                },
                "plotType": "LINE",
                "targetAxis": "Y1",
                "legendTemplate": "Web"
              }
            ],
            "yAxis": {
              "label": "Memory usage (bytes)",
              "scale": "LINEAR"
            }
          }
        },
        {
          "title": "Network Traffic by Pod",
          "xyChart": {
            "dataSets": [
              {
                "timeSeriesQuery": {
                  "timeSeriesFilter": {
                    "filter": "resource.type=\"k8s_pod\" AND metric.type=\"kubernetes.io/pod/network/received_bytes_count\" AND resource.labels.pod_name=monitoring.regex.full_match(\"api-deployment.*\") AND resource.labels.cluster_name=\"cluster-1\"",
                    "aggregation": {
                      "perSeriesAligner": "ALIGN_RATE",
                      "crossSeriesReducer": "REDUCE_SUM"
                    }
                  },
                  "unitOverride": "By"
                },
                "plotType": "LINE",
                "targetAxis": "Y1",
                "legendTemplate": "API Received"
              },
              {
                "timeSeriesQuery": {
                  "timeSeriesFilter": {
                    "filter": "resource.type=\"k8s_pod\" AND metric.type=\"kubernetes.io/pod/network/sent_bytes_count\" AND resource.labels.pod_name=monitoring.regex.full_match(\"api-deployment.*\") AND resource.labels.cluster_name=\"cluster-1\"",
                    "aggregation": {
                      "perSeriesAligner": "ALIGN_RATE",
                      "crossSeriesReducer": "REDUCE_SUM"
                    }
                  },
                  "unitOverride": "By"
                },
                "plotType": "LINE",
                "targetAxis": "Y1",
                "legendTemplate": "API Sent"
              },
              {
                "timeSeriesQuery": {
                  "timeSeriesFilter": {
                    "filter": "resource.type=\"k8s_pod\" AND metric.type=\"kubernetes.io/pod/network/received_bytes_count\" AND resource.labels.pod_name=monitoring.regex.full_match(\"web-deployment.*\") AND resource.labels.cluster_name=\"cluster-1\"",
                    "aggregation": {
                      "perSeriesAligner": "ALIGN_RATE",
                      "crossSeriesReducer": "REDUCE_SUM"
                    }
                  },
                  "unitOverride": "By"
                },
                "plotType": "LINE",
                "targetAxis": "Y1",
                "legendTemplate": "Web Received"
              },
              {
                "timeSeriesQuery": {
                  "timeSeriesFilter": {
                    "filter": "resource.type=\"k8s_pod\" AND metric.type=\"kubernetes.io/pod/network/sent_bytes_count\" AND resource.labels.pod_name=monitoring.regex.full_match(\"web-deployment.*\") AND resource.labels.cluster_name=\"cluster-1\"",
                    "aggregation": {
                      "perSeriesAligner": "ALIGN_RATE",
                      "crossSeriesReducer": "REDUCE_SUM"
                    }
                  },
                  "unitOverride": "By"
                },
                "plotType": "LINE",
                "targetAxis": "Y1",
                "legendTemplate": "Web Sent"
              }
            ],
            "yAxis": {
              "label": "Network traffic (bytes/s)",
              "scale": "LINEAR"
            }
          }
        },
        {
          "title": "Container Restarts",
          "xyChart": {
            "dataSets": [
              {
                "timeSeriesQuery": {
                  "timeSeriesFilter": {
                    "filter": "resource.type=\"k8s_container\" AND metric.type=\"kubernetes.io/container/restart_count\" AND resource.labels.cluster_name=\"cluster-1\"",
                    "aggregation": {
                      "perSeriesAligner": "ALIGN_DELTA",
                      "crossSeriesReducer": "REDUCE_NONE",
                      "groupByFields": [
                        "resource.label.pod_name"
                      ]
                    }
                  },
                  "unitOverride": "1"
                },
                "plotType": "STACKED_BAR",
                "targetAxis": "Y1"
              }
            ],
            "yAxis": {
              "label": "Restart count",
              "scale": "LINEAR"
            }
          }
        },
        {
          "title": "Pod Status",
          "xyChart": {
            "dataSets": [
              {
                "timeSeriesQuery": {
                  "timeSeriesFilter": {
                    "filter": "resource.type=\"k8s_pod\" AND metric.type=\"kubernetes.io/pod/status.phase\" AND resource.labels.cluster_name=\"cluster-1\" AND (resource.labels.pod_name=monitoring.regex.full_match(\"api-deployment.*\") OR resource.labels.pod_name=monitoring.regex.full_match(\"web-deployment.*\"))",
                    "aggregation": {
                      "perSeriesAligner": "ALIGN_MEAN",
                      "crossSeriesReducer": "REDUCE_NONE"
                    }
                  },
                  "unitOverride": "1"
                },
                "plotType": "LINE",
                "targetAxis": "Y1"
              }
            ],
            "yAxis": {
              "label": "Status (0=Pending, 1=Running, 2=Succeeded, 3=Failed, 4=Unknown)",
              "scale": "LINEAR"
            }
          }
        },
        {
          "title": "API Container Logs Entries",
          "xyChart": {
            "dataSets": [
              {
                "timeSeriesQuery": {
                  "timeSeriesFilter": {
                    "filter": "resource.type=\"k8s_container\" AND metric.type=\"logging.googleapis.com/log_entry_count\" AND resource.labels.container_name=\"api\" AND resource.labels.cluster_name=\"cluster-1\"",
                    "aggregation": {
                      "perSeriesAligner": "ALIGN_RATE",
                      "crossSeriesReducer": "REDUCE_SUM",
                      "groupByFields": [
                        "metric.label.severity"
                      ]
                    }
                  },
                  "unitOverride": "1"
                },
                "plotType": "STACKED_BAR",
                "targetAxis": "Y1"
              }
            ],
            "yAxis": {
              "label": "Log entries per second",
              "scale": "LINEAR"
            }
          }
        }
      ]
    }
  }