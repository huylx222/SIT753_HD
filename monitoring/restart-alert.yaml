displayName: "Frequent Container Restart Alert"
documentation:
  content: "Containers are restarting frequently. This may indicate application crashes or resource issues."
  mimeType: "text/markdown"
combiner: OR
conditions:
- displayName: "K8s Container - Frequent restarts"
  conditionThreshold:
    filter: 'resource.type="k8s_container" AND (resource.labels.container_name="api" OR resource.labels.container_name="web") AND metric.type="kubernetes.io/container/restart_count"'
    comparison: COMPARISON_GT
    thresholdValue: 3
    duration: 600s
    trigger:
      count: 1
    aggregations:
    - alignmentPeriod: 300s
      perSeriesAligner: ALIGN_DELTA
      crossSeriesReducer: REDUCE_SUM
      groupByFields:
      - resource.labels.container_name
alertStrategy:
  autoClose: 3600s
  notificationRateLimit:
    period: 300s
severity: WARNING
enabled: true